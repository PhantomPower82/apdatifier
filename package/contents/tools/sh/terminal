#!/usr/bin/env bash

# SPDX-FileCopyrightText: 2024 Evgeny Kazantsev <exequtic@gmail.com>
# SPDX-License-Identifier: MIT

source "$(dirname "$0")/vars"

term="$(basename $terminal)"
scr="$(dirname "$0")/$1"
arg="${@:2}"

if [[ $term = "yakuake" ]]; then
    qdbusCMD() { qdbus6 org.kde.yakuake /yakuake/$1 "${@:2}"; }
    session=$(qdbusCMD sessions addSession)
    qdbusCMD tabs org.kde.yakuake.setTabTitle $session "Upgrade"
    qdbusCMD sessions runCommandInTerminal $session "bash -c 'tput sc; clear; $scr $arg'"
else
    declare -A termArg=( ["gnome-terminal"]=" --" ["terminator"]=" -x" )
    cmd="$term${termArg[$term]:-" -e"} bash -c '\"$scr\" $arg'"
    eval ${cmd}
fi
